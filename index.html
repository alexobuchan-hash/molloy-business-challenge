<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#950423">
    <title>Molloy Business Challenge</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* BASE STYLES */
        body {
            background-color: #950423; /* Default to Maroon so it's never white */
            font-family: sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            color: white;
        }

        /* ERROR BOX (Hidden unless things break) */
        #error-console {
            display: none;
            background: black;
            color: lime;
            padding: 20px;
            font-family: monospace;
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 9999;
            white-space: pre-wrap;
        }

        /* SCREENS */
        .screen {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
            background: #f4f4f9;
            color: #333;
        }

        /* LOGIN SCREEN (Specific Override) */
        #login-screen {
            display: flex; /* Force visible immediately */
            background: #950423;
            color: white;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .login-content { width: 80%; max-width: 300px; }
        .logo { font-size: 80px; color: #D6C172; margin-bottom: 20px; }
        .title { font-size: 24px; font-weight: bold; margin-bottom: 40px; text-transform: uppercase; }
        
        input {
            width: 100%; padding: 15px; margin-bottom: 15px;
            border-radius: 8px; border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1); color: white;
            box-sizing: border-box; /* Fix padding issues */
        }
        
        button {
            width: 100%; padding: 15px; border-radius: 30px;
            border: none; font-weight: bold; font-size: 16px;
            cursor: pointer; margin-top: 10px;
        }
        .btn-primary { background: #D6C172; color: #950423; }
        .btn-google { background: white; color: #333; }

        /* APP HEADER */
        header {
            background: #950423; color: white; padding: 40px 20px 20px;
            text-align: center; border-radius: 0 0 20px 20px;
        }

        /* QUIZ CARD */
        .card {
            background: white; border-radius: 15px; padding: 20px;
            margin: 20px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            color: #333;
        }

        .option-btn {
            background: white; border: 2px solid #eee; width: 100%;
            padding: 15px; margin-bottom: 10px; border-radius: 10px;
            text-align: left; font-size: 16px;
        }

        /* FOOTER NAV */
        .nav {
            position: fixed; bottom: 0; width: 100%; background: white;
            display: flex; justify-content: space-around; padding: 15px 0;
            border-top: 1px solid #eee;
        }
        .nav-item { text-align: center; font-size: 12px; color: #999; }
        .nav-item.active { color: #950423; font-weight: bold; }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 5px; }

    </style>
</head>
<body>

    <div id="error-console"></div>

    <div id="login-screen" class="screen active">
        <div class="login-content">
            <div class="logo"><i class="fas fa-university"></i></div>
            <div class="title">Molloy Business<br>Challenge</div>
            
            <input type="email" id="email" placeholder="student@molloy.edu">
            <input type="password" placeholder="Password">
            
            <button class="btn-primary" onclick="tryLogin()">Login</button>
            <button class="btn-google" onclick="tryLogin()">Sign in with Google</button>
        </div>
    </div>

    <div id="app-screen" class="screen">
        <header>
            <div style="font-size:12px; opacity:0.8; text-transform:uppercase;">Molloy University</div>
            <div style="font-size:24px; font-weight:bold; color:#D6C172; margin-top:10px;">
                <i class="fas fa-wallet"></i> <span id="balance">0</span> MD
            </div>
            <div id="username-display" style="margin-top:5px; font-size:14px;">Welcome</div>
        </header>

        <div id="view-quiz" style="flex:1; overflow-y:auto;">
            <div class="card">
                <div style="color:#888; font-size:12px; margin-bottom:10px;">LEVEL 1: VALUE CREATION</div>
                <h3 id="q-text" style="margin-bottom:20px;">Loading Question...</h3>
                <div id="options-area"></div>
                <p id="feedback" style="height:20px; color:#950423; font-weight:bold;"></p>
            </div>
        </div>

        <div id="view-wallet" style="display:none; flex:1; padding:20px;">
            <h2>Transaction History</h2>
            <div id="wallet-list"></div>
        </div>

        <div id="view-profile" style="display:none; flex:1; padding:20px; text-align:center;">
            <div style="width:80px; height:80px; background:#ccc; border-radius:50%; margin:0 auto 20px;"></div>
            <h2 id="p-name">Student</h2>
            <p id="p-email">email@molloy.edu</p>
            <button onclick="location.reload()" style="background:#333; color:white; margin-top:50px;">Log Out</button>
        </div>

        <div class="nav">
            <div class="nav-item active" onclick="switchTab('quiz', this)"><i class="fas fa-gamepad"></i> Quiz</div>
            <div class="nav-item" onclick="switchTab('wallet', this)"><i class="fas fa-wallet"></i> Wallet</div>
            <div class="nav-item" onclick="switchTab('profile', this)"><i class="fas fa-user"></i> Profile</div>
        </div>
    </div>

    <script>
        // ERROR HANDLER: Catches crashes and shows them on screen
        window.onerror = function(msg, url, line) {
            document.getElementById('error-console').style.display = 'block';
            document.getElementById('error-console').innerText = "ERROR:\n" + msg + "\nLine: " + line;
            return false;
        };

        // --- APP DATA ---
        const questions = [
            { q: "According to 'The Personal MBA', every successful business creates something of...?", options: ["Value", "Cost", "Complexity"], correct: 0 },
            { q: "Which is NOT one of the 5 parts of every business?", options: ["Marketing", "Sales", "Office Politics"], correct: 2 },
            { q: "What is the term for 'making people want what you have'?", options: ["Accounting", "Marketing", "HR"], correct: 1 }
        ];

        let state = { balance: 0, qIndex: 0, name: "Student" };

        // --- FUNCTIONS ---
        function tryLogin() {
            try {
                const email = document.getElementById('email').value;
                if(email.includes('@')) state.name = email.split('@')[0];
                
                document.getElementById('username-display').innerText = "Player: " + state.name;
                document.getElementById('p-name').innerText = state.name;
                document.getElementById('p-email').innerText = email;

                // HIDE Login, SHOW App
                document.getElementById('login-screen').style.display = 'none'; 
                document.getElementById('app-screen').style.display = 'flex';
                
                renderQuestion();
            } catch(e) {
                alert("Login Error: " + e.message);
            }
        }

        function renderQuestion() {
            if(state.qIndex >= questions.length) {
                document.getElementById('q-text').innerText = "Level Complete!";
                document.getElementById('options-area').innerHTML = "<button onclick='location.reload()'>Restart</button>";
                return;
            }
            
            const q = questions[state.qIndex];
            document.getElementById('q-text').innerText = q.q;
            const area = document.getElementById('options-area');
            area.innerHTML = "";

            q.options.forEach((opt, idx) => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => handleAnswer(idx, btn);
                area.appendChild(btn);
            });
        }

        function handleAnswer(idx, btn) {
            const correct = questions[state.qIndex].correct;
            if(idx === correct) {
                btn.style.background = "#d4edda"; // Green
                state.balance += 10;
                document.getElementById('balance').innerText = state.balance;
                document.getElementById('feedback').innerText = "Correct! +10 MD";
                
                // Add to wallet history
                const entry = document.createElement('div');
                entry.innerText = `+10 MD (Q${state.qIndex+1})`;
                entry.style.padding = "10px";
                entry.style.borderBottom = "1px solid #eee";
                document.getElementById('wallet-list').prepend(entry);

                setTimeout(() => {
                    state.qIndex++;
                    document.getElementById('feedback').innerText = "";
                    renderQuestion();
                }, 1000);
            } else {
                btn.style.background = "#f8d7da"; // Red
                document.getElementById('feedback').innerText = "Try again!";
            }
        }

        function switchTab(tab, el) {
            // Reset Nav Colors
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');

            // Hide all views
            document.getElementById('view-quiz').style.display = 'none';
            document.getElementById('view-wallet').style.display = 'none';
            document.getElementById('view-profile').style.display = 'none';

            // Show selected
            document.getElementById('view-' + tab).style.display = 'block';
        }
    </script>
</body>
</html>
